var Rebrander,__bind=function(a,b){return function(){return a.apply(b,arguments)}};$.fn.rebrand=function(a){return void 0!==SVG&&SVG.supported?new Rebrander(this,a):void 0},Rebrander=function(){function a(a,b){var c,d,e,f=this;if(this.el=a,null==b&&(b={}),this.colorize=__bind(this.colorize,this),this.id=this.el.attr("id"),this.src=this.el.attr("src"),this.el.hide(),!a.is("img")||!this.id)return"undefined"!=typeof console&&null!==console?"function"==typeof console.log?console.log("Rebrander works with img tags with id"):void 0:void 0;this.options={},e=this.defaults;for(c in e)d=e[c],this.options[c]=typeof b[c]==typeof this.defaults[c]?b[c]:this.defaults[c];this.setup(),this.img=new Image,this.img.onload=function(){return f.render(f.img)},this.img.src=this.src}return a.prototype.defaults={max:200,min:100,red:156,green:191,blue:144,interval:200,delta:1,zindex:10,type:"linear"},a.prototype.colors=["red","green","blue"],a.prototype.mapping={red:["green","blue"],blue:["red","green"],green:["red","blue"]},a.prototype.setup=function(){var a,b,c,d,e;for(this.options.delta%2>0&&this.options.delta++,d=this.colors,e=[],b=0,c=d.length;c>b;b++)a=d[b],this.options[a]<this.options.min&&(this.options[a]=this.options.min),this.options[a]>this.options.max?e.push(this.options[a]=this.options.max):e.push(void 0);return e},a.prototype.render=function(){return this.width=this.el.width(),this.height||(this.scale=this.width/this.img.width,this.height=parseInt(this.img.height*this.scale)),this.replace(),this.start()},a.prototype.replace=function(){var a=this;return this.hid=this.id+"_rebrander",this.holder=$("<div>").attr({id:this.hid}).css({width:this.width,height:this.height,"z-index":this.options.zindex}),this.el.replaceWith(this.holder),this.holder.on("click",function(){return"undefined"!=typeof console&&null!==console?"function"==typeof console.log?console.log(a.options.red,a.options.green,a.options.blue):void 0:void 0})},a.prototype.start=function(){return this.draw=SVG(this.hid),this.rect=this.draw.rect().size(this.width,this.height).fill("none"),this.mask=this.draw.image(this.src).size(this.width,this.height),this.colorize(),setInterval(this.colorize,this.options.interval)},a.prototype.color=function(a){var b;return b=this.colors[this.cur],a?this.options[b]=a:this.options[b]},a.prototype.colorize=function(){var a,b,c,d,e,f=this;if(null==this.cur&&(this.cur=0),this.color()>=this.options.max)this.cur=2===this.cur?0:this.cur+1;else for(this.color(this.color()+this.options.delta),e=this.mapping[this.colors[this.cur]],c=0,d=e.length;d>c;c++)a=e[c],this.options[a]>this.options.min&&(this.options[a]=this.options[a]-this.options.delta/2);return b=this.draw.gradient(this.options.type,function(a){return a.at({offset:0,color:{r:f.options.red,g:f.options.green,b:f.options.blue}}),a.at({offset:1,color:{r:f.options.blue,g:f.options.red,b:f.options.green}})}),this.rect.fill({color:b}),this.rect.maskWith(this.mask)},a.prototype.shift=function(a){var b;return b=a.length,a.unshift(a[a.length-1]),a.length=b,a},a}();